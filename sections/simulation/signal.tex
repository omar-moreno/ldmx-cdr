
\subsection{External Physics Generator for Signal Reaction (Dark Matter Production) (Editor: Natalia Toro)}
While background processes are modelled entirely in the Geant4 framework, the new physics of Dark Matter production is modelled using an external event generator based on MadGraph/MadEvent4 \cite{MG4}.  Here we describe this generator, its validation, and the interface with Geant4.

MadGraph is an automated tool for calculating the tree-level amplitudes for arbitrary physics processes, which allows users to define Feynman rules for new physics models; MadEvent is a Monte Carlo event generator based on MadGraph.  MadGraph/MadEvent4 (MG/ME) was designed for the study of high-energy collider reactions, but minor modifications to the code (introducing non-zero masses for incident particles and for the electron, and an electromagnetic form factor as described in \cite{Tsai} for the nucleus) allow for its application to fixed-target processes.  These modifications and a new-physics model that introduces a dark photon with arbitrary mass and kinetic mixing $\epsilon$ with the photon has been used for  the APEX test run \cite{APEXtest} and HPS experiment \cite{HPStest}.  For LDMX, we have added light dark matter particles (either fermions or scalars) that couple to the dark photon with an arbitrary interaction strength $g_D$.  This allows us to simulate the signal process of DM particle pair-production via either decay of an on-shell $A'$ or off-shell $A'$ exchange.   This report focuses on the on-shell production process, though the kinematics of the two are very similar.  

\draft{Do we want to say something explicit about the form factors?}

Within MG/ME, we generate events for the DM production process $e^- W \rightarrow e^- W \,(A^\prime \rightarrow \chi \bar\chi)$ where $\chi$ represents the dark matter particle and $\bar\chi$ its antiparticle. Events are generated assuming a 4 GeV incident electron and Tungsten nucleus at rest as the initial state.  MG/ME computes a Monte Carlo approximation of the inclusive cross-section for this process, and generates a sample of unweighted events in the Les Houches Event (LHE) format \cite{LHE}.  The inclusive cross-section computed by MadGraph is stable within $1\%$ and is consistent within $\sim 30\%$ with independent calculation of the cross-section in the Weizsacker-Williams (WW) approximation from \cite{Andreas09}.  The deviations from the WW inclusive cross-section are largest at high and low masses, and compatible with the size of errors expected in the WW approximation.

\draft{[IS THSI RIGHT?] To seed Geant4 events from the MG/ME output, we read the four-momentum of the recoiling electron \draft{and Tungsten nucleus??} from the LHE file and use these to populate an STDHEP event.  The electron and nucleus are assumed to originate from a common vertex, uniformly distributed over the thickness of the target and over a transverse region spanning \bf{CHECK!} $\pm 1 \cm$ in the $x$ direction and $\pm 2 \cm$ in the $y$ direction about the nominal center of the target.}

